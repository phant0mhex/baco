<!DOCTYPE html>
<html lang="fr" class="h-full bg-gray-50">
<head>
  <meta charset="UTF-8">
  <title>Mon Profil - Portail BACO</title>
      <link rel="icon" type="image/png" href="favicon.jpg">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Geist&family=Geist+Mono&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/lucide@0.303.0/dist/umd/lucide.min.js" defer></script> 
 <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://unpkg.com/flatpickr"></script>
  <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script>
<link rel="stylesheet" href="https://unpkg.com/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://unpkg.com/notyf@3/notyf.min.css">
  <script src="https://unpkg.com/notyf@3/notyf.min.js"></script>
  
 

  <style>
    /* Style pour l'upload d'avatar */
    .avatar-upload-label { cursor: pointer; position: relative; display: inline-block; width: 128px; height: 128px; }
    .avatar-upload-label:hover .avatar-overlay { opacity: 1; }
    .avatar-overlay { position: absolute; inset: 0; background-color: rgba(0,0,0,0.4); color: white; display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.2s; border-radius: 9999px; }
  </style>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Geist', 'sans-serif'],
            mono: ['Geist Mono', 'monospace'],
          },
        },
      },
    }
  </script>
  <style>
  /* Cacher le corps par défaut jusqu'à ce que l'auth soit vérifiée */
  body {
    visibility: hidden;
  }
</style>
</head>
<body class="flex flex-col min-h-screen">

  <div id="nav-placeholder"></div>
<div class="flex-grow">
  <div class="container mx-auto p-8 max-w-2xl">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">
        Mon Profil <span id="admin-badge" class="ml-2"></span>
    </h1>
    
    <div class="bg-white p-6 rounded-lg shadow border border-gray-200 mb-8">
      <form id="profile-form">
        <div class="flex flex-col items-center gap-4 mb-6">
          <label for="avatar-file" class="avatar-upload-label">
            <img id="avatar-preview" src="https://via.placeholder.com/128" alt="Avatar" class="w-32 h-32 rounded-full object-cover border border-gray-300">
            <div class="avatar-overlay">
              <i data-lucide="camera" class="w-8 h-8"></i>
            </div>
          </label>
          <input type="file" id="avatar-file" class="hidden" accept="image/png, image/jpeg">
          <span id="avatar-upload-status" class="text-sm text-gray-500"></span>
        </div>

        <div class="space-y-4">
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
            <input type="email" id="email" disabled class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed">
          </div>
          <div>
            <label for="role" class="block text-sm font-medium text-gray-700">Rôle</label>
            <input type="text" id="role" disabled class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 cursor-not-allowed">
          </div>
          <div>
            <label for="username" class="block text-sm font-medium text-gray-700">Nom d'utilisateur</label>
            <input type="text" id="username" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
          </div>
          <div>
            <label for="full_name" class="block text-sm font-medium text-gray-700">Nom complet</label>
            <input type="text" id="full_name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
          </div>
          
          <div class="flex justify-end pt-4">
            <button type="submit" id="save-button" class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition-colors">
              Enregistrer les modifications
            </button>
          </div>
        </div>
      </form>
    </div>


<div class="bg-white p-6 rounded-lg shadow border border-gray-200 mb-8">
  <h2 class="text-xl font-semibold text-gray-900 mb-4">Mon Casier d'Infractions</h2>

  <div class="mb-6">
    <label class="block text-sm font-medium text-gray-700 mb-2">Niveau de Confiance</label>
    <div class="w-full bg-gray-200 rounded-full h-5 overflow-hidden shadow-inner">
      <div id="ban-meter-fill" 
           class="h-5 rounded-full text-right text-xs text-white font-bold pr-2 transition-all duration-1000 ease-out"
           style="width: 100%;"
           >
           </div>
    </div>
    <p class="text-xs text-gray-500 mt-1 text-center" id="ban-meter-status">Chargement...</p>
  </div>

  <h3 class="text-lg font-medium text-gray-800 mb-3">Historique des cartons :</h3>
  <div id="infractions-list" class="space-y-3 max-h-60 overflow-y-auto pr-2">
    <p class="text-gray-500 text-sm">Chargement de votre historique...</p>
  </div>
</div>


    <div class="bg-white p-6 rounded-lg shadow border border-gray-200">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Sécurité</h2>
      <form id="password-form" class="space-y-4">
        <div>
          <label for="new-password" class="block text-sm font-medium text-gray-700">Nouveau mot de passe</label>
          <input type="password" id="new-password" required minlength="6" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div>
          <label for="confirm-password" class="block text-sm font-medium text-gray-700">Confirmer le mot de passe</label>
          <input type="password" id="confirm-password" required minlength="6" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
        </div>
        <div class="flex justify-end pt-4">
            <button type="submit" id="password-save-button" class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition-colors">
              Changer le mot de passe
            </button>
          </div>
      </form>
    </div>

  </div>

<script src="js/core/layout.js" type="module"></script>
  <script src="js/pages/profil.js" type="module"></script>
  
<div id="footer-placeholder"></div>
</div>
</body>
</html>